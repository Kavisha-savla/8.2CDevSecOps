pipeline {
 agent any
 stages {
 stage('Checkout') {
 steps {
 git branch: 'main', url: ' https://github.com/Kavisha-savla/8.2CDevSecOps.git'
 }
 }
 stage('Install Dependencies') {
 steps {
 bat 'npm install'
 }
 }
stage('Run Tests') {
    steps {
        catchError(buildResult: 'SUCCESS', stageResult: 'FAILURE') {
            // Run npm test but skip snyk or handle snyk auth externally
            bat 'npm test'
        }
    }
}

stage('Generate Coverage Report') {
    steps {
        // If coverage script doesn't exist, comment this out or add your coverage command
        // bat 'npm run coverage'
        echo 'Coverage stage skipped because no coverage script defined'
    }
}

 steps {
 bat 'npm audit || true' // This will show known CVEs in the output
 }
 }
 }
}
